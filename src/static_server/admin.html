<!doctype html>
<html lang="ru">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Togetherness Admin</title>
</head>

<script>
    function submitForm(url, valueId) {
        var value = document.querySelector(`input[id="${valueId}"]`).value;
        fetch(url, {
            method: 'POST',
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            body: value
        })
            .then((response) => response.json())
            .then(response => {
                if (response.error == "AlreadyStarted") {
                    alert("Сначала надо остановить таймер");
                } else if (response.error == "NotStarted") {
                    alert("Сначала надо запустить таймер");
                } else if (response.error == "SetToZero") {
                    alert("Сначала надо задать продолжительность ночи");
                } else if (response.error == "MultiThread") {
                    alert("Внутренняя ошибка, ничего не получилось");
                } else if (response.error == "None") {
                    alert("Ok");
                }
            })
    }
</script>

<body>
    <h1>Праздник Единения: админка</h1>

    <h2>Таймер: <i>{{timer.minutes}}:{{timer.seconds}}</i> *</h2>
    <p>* Страница была загружена, когда до окончания Ночи оставалось столько. Чтобы увидеть текущее состояние таймера,
        обновите страницу.</p>

    <h2>Управление</h2>
    <form>
        <label for="duration">Продолжительность игры:</label>
        <input id="duration" type="number" step="1" min="1" max="240" value="30" pattern="\d+" />
        минут.
        <input id="save" type="button" value="Сохранить" onclick="submitForm('/api/admin/duration', 'duration')">
    </form>
    <p><input id="start" type="button" value="Старт" onclick="submitForm('/api/admin/start', 'start')"></p>
    <p><input id="stop" type="button" value="Стоп" onclick="submitForm('/api/admin/stop', 'stop')"></p>

    <h2>Статистика</h2>
    <h3>Фракции</h3>
    <!-- Количество игроков -->
    <!-- Количество золота -->
    <h3>Взаимодействия</h3>
    <!-- Объятия: количество -->
    <!-- Подслушивания: количество -->
    <!-- Шантаж: количество -->
    <!-- Слухи: количество -->
    <!-- Преступления: количество -->
</body>

</html>
