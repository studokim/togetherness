<!doctype html>
<html lang="ru">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Togetherness Admin</title>
</head>

<script>
    function submitForm(url, valueId) {
        var value = document.querySelector(`input[id="${valueId}"]`).value;
        fetch(url, {
            method: 'POST',
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            body: value
        })
            .then((response) => response.json())
            .then(response => {
                if (response.error == "AlreadyStarted") {
                    alert("Сначала надо остановить таймер");
                } else if (response.error == "NotStarted") {
                    alert("Сначала надо запустить таймер");
                } else if (response.error == "SetToZero") {
                    alert("Сначала надо задать продолжительность ночи");
                } else if (response.error == "MultiThread") {
                    alert("Внутренняя ошибка, ничего не получилось");
                } else if (response.error == "None") {
                    alert("Ok");
                }
            })
    }
</script>

<body>
    <h1>Праздник Единения: админка</h1>

    <h2>Таймер: <i>{{timer}}</i> *</h2>
    <p>* Страница была загружена, когда до окончания Ночи оставалось столько. Чтобы увидеть текущее состояние таймера,
        обновите страницу.</p>

    <h2>Управление</h2>
    <form>
        <label for="duration">Продолжительность игры:</label>
        <input id="duration" type="number" step="1" min="1" max="240" placeholder="1–240" size="6" pattern="\d+" />
        минут.
        <input id="save" type="button" value="Установить" onclick="submitForm('/api/admin/duration', 'duration')">
    </form>
    <p>
        <input id="start" type="button" value="Старт" onclick="submitForm('/api/admin/start', 'start')">
        <input id="stop" type="button" value="Экстренный стоп" onclick="submitForm('/api/admin/stop', 'stop')"> *
    </p>
    <p>* Игроки не смогут взаимодействовать до повторного нажатия кнопки «старт», состояние таймера будет сброшено.
        Профили игроков и история взаимодействий будут сохранены. Не забудьте сократить время игры, прежде чем снова
        нажимать «старт».</p>

    <h2>Статистика</h2>
    <h3>Фракции</h3>
    <!-- Количество игроков -->
    <!-- Количество золота -->
    <h3>Взаимодействия</h3>
    За прошедшее время игроки проделали друг с другом следующее:
    <ul>
        <li>Обняли: <i>{{stats.hug}}</i> раз</li>
        <li>Подслушали: <i>{{stats.eavesdropping}}</i> раз</li>
        <li>Шантажировали: <i>{{stats.blackmail}}</i> раз</li>
        <li>Пустили слухи: <i>{{stats.gossip}}</i> раз</li>
        <li>Совершили преступление: <i>{{stats.crime}}</i> раз</li>
    </ul>
</body>

</html>
